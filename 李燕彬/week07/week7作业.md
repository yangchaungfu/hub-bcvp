# 20251130-week07-第七周作业

## 作业内容和要求：多模型正负样本训练与预测

对文本分类问题进行多模型对比分析，使用贝叶斯、SVM、CNN和LSTM四种模型进行正负样本分类，并记录各模型的训练过程和预测结果。

## 作业实践环境与数据

### 运行环境
- Python 3.8.10
- PyTorch（用于CNN和LSTM模型）
- Scikit-learn（用于SVM模型）
- 其他依赖库：pandas、numpy、jieba等

### 数据集：将老师提供的“文本分类练习.csv”，按7:2:1的比例随机分成训练集、测试集、验证集
- 训练集：[train.csv](train.csv)
- 测试集：[test.csv](test.csv)
- 验证集：[valid.csv](valid.csv)

数据格式：
```csv
label,review
```
- `label`：分类标签（0或1，分别表示负样本和正样本）
- `review`：文本评论内容

## 课堂中提到的各个模型在本次实验中的应用

### 1. 贝叶斯模型
[bayes_text_classifier.py](bayes_text_classifier.py)
- 基于朴素贝叶斯算法的文本分类器
- 使用加1平滑处理
- 简单高效，适合大规模文本分类

### 2. SVM模型
[svm_text_classifier.py](svm_text_classifier.py)
- 支持向量机分类器
- 使用TF-IDF进行文本向量化
- 尝试不同的C值（0.1, 1.0, 10.0）和核函数（linear, rbf）

### 3. CNN模型
[cnn_text_classifier.py](cnn_text_classifier.py)
- 卷积神经网络
- 包含词嵌入层、卷积层、池化层和全连接层
- 调整学习率（0.0001-0.001）和隐藏层大小（128-256）

### 4. LSTM模型
[lstm_text_classifier.py](lstm_text_classifier.py)
- 长短期记忆网络
- 包含词嵌入层、LSTM层和全连接层
- 调整学习率（0.0001-0.001）、隐藏层大小（128-256）和层数（1-2）

## 作业实验执行过程

### 1. 实验准备
[experiment_manager.py](experiment_manager.py)
- 创建`ExperimentManager`类用于统一管理实验流程和结果记录
- 实现各模型的训练和预测方法
- 设计CSV文件格式用于记录实验结果

### 2. 贝叶斯模型实验
- 执行3次训练
- 记录测试准确率、验证集预测耗时和训练时间

### 3. SVM模型实验
- 执行5次训练，使用不同的超参数组合
- 记录测试准确率、验证集预测耗时和训练时间

### 4. CNN模型实验
- 执行5次训练，使用不同的学习率和隐藏层大小
- 记录训练损失值、测试准确率、验证集预测耗时和训练时间

### 5. LSTM模型实验
- 执行3次训练，使用不同的学习率和隐藏层大小
- 记录训练损失值、测试准确率、验证集预测耗时和训练时间

## 实验结果分析

### 实验结果汇总

所有实验结果已记录在[experiment_results.csv](experiment_results.csv)文件中，包含以下字段：
- 模型类型
- 实验次数
- 学习率
- 隐藏层大小
- 训练损失值
- 测试集准确率
- 验证集每100条预测耗时(s)
- 训练时间(s)

### 各模型性能对比

#### 1. 贝叶斯模型
| 实验次数 | 学习率 | 隐藏层大小 | 训练损失值 | 测试集准确率 | 验证集每100条预测耗时(s) | 训练时间(s) |
|---------|-------|-----------|-----------|-------------|-------------------------|------------|
| 1       | 0.0   | 0         | 0.0       | 0.8707      | 0.0297                  | 3.9403     |
| 2       | 0.0   | 0         | 0.0       | 0.8707      | 0.0304                  | 3.2807     |
| 3       | 0.0   | 0         | 0.0       | 0.8707      | 0.0331                  | 4.4846     |

- 准确率稳定在87.07%
- 训练速度快，每次训练约3-4秒
- 验证集预测效率高

#### 2. SVM模型
| 实验次数 | 学习率 | 隐藏层大小 | 训练损失值 | 测试集准确率 | 验证集每100条预测耗时(s) | 训练时间(s) |
|---------|-------|-----------|-----------|-------------|-------------------------|------------|
| 1       | 0.1   | 0         | 0.0       | 0.8335      | 0.0212                  | 3.3103     |
| 2       | 1.0   | 0         | 0.0       | 0.8669      | 0.0160                  | 2.6397     |
| 3       | 10.0  | 0         | 0.0       | 0.8385      | 0.0136                  | 3.9865     |
| 4       | 1.0   | 0         | 0.0       | 0.8686      | 0.0387                  | 4.2273     |
| 5       | 10.0  | 0         | 0.0       | 0.8544      | 0.0321                  | 6.5871     |

- 准确率范围：83.35%-86.86%
- 最佳配置：C=1.0，rbf核，准确率86.86%
- 训练速度快，每次训练约2-6秒

#### 3. CNN模型
| 实验次数 | 学习率 | 隐藏层大小 | 训练损失值 | 测试集准确率 | 验证集每100条预测耗时(s) | 训练时间(s) |
|---------|-------|-----------|-----------|-------------|-------------------------|------------|
| 1       | 0.001 | 128       | 0.2969    | 0.8782      | 0.1004                  | 128.6519   |
| 2       | 0.001 | 256       | 0.2933    | 0.8744      | 0.1022                  | 1733.5639  |
| 3       | 0.0001| 128       | 0.4830    | 0.8273      | 0.1081                  | 144.0568   |
| 4       | 0.001 | 128       | 0.2865    | 0.8819      | 0.1664                  | 205.7646   |
| 5       | 0.0005| 256       | 0.3147    | 0.8723      | 0.2904                  | 231.0419   |

- 准确率范围：82.73%-88.19%
- 最佳配置：学习率0.001，隐藏层128，准确率88.19%
- 训练时间随隐藏层增大而显著增加

#### 4. LSTM模型
| 实验次数 | 学习率 | 隐藏层大小 | 训练损失值 | 测试集准确率 | 验证集每100条预测耗时(s) | 训练时间(s) |
|---------|-------|-----------|-----------|-------------|-------------------------|------------|
| 1       | 0.001 | 128       | 0.3158    | 0.8890      | 0.1233                  | 181.9709   |
| 2       | 0.001 | 256       | 0.3051    | 0.8511      | 0.2882                  | 2020.1153  |
| 3       | 0.0001| 128       | 0.4974    | 0.8365      | 0.1228                  | 169.1177   |

- 准确率范围：83.65%-88.90%
- 最佳配置：学习率0.001，隐藏层128，准确率88.90%
- 训练时间长，特别是隐藏层256时约33分钟

## 实验结果可视化

### 准确率对比
| 模型 | 最高准确率 |
|------|-----------|
| 贝叶斯 | 87.07% |
| SVM | 86.86% |
| CNN | 88.19% |
| LSTM | 88.90% |

### 训练时间对比
| 模型 | 平均训练时间 | 最长训练时间 |
|------|------------|------------|
| 贝叶斯 | 约3.9秒 | 4.48秒 |
| SVM | 约3.75秒 | 6.59秒 |
| CNN | 约464秒 | 1733秒 |
| LSTM | 约790秒 | 2020秒 |

## 结论与建议

### 主要结论

1. **模型性能**：
   - LSTM模型在准确率方面表现最佳（88.90%）
   - CNN模型紧随其后（88.19%）
   - 贝叶斯模型和SVM模型表现相当，准确率在87%左右

2. **训练效率**：
   - 贝叶斯和SVM模型训练速度极快，适合大规模数据处理
   - CNN模型训练时间适中，在可接受范围内
   - LSTM模型训练时间较长，特别是当隐藏层较大时

3. **预测效率**：
   - 贝叶斯和SVM模型预测速度最快
   - CNN和LSTM模型预测速度相对较慢，但仍在可接受范围内

### 建议

1. **根据应用场景选择模型**：
   - 对实时性要求高的场景：推荐使用贝叶斯或SVM模型
   - 对准确率要求高的场景：推荐使用LSTM或CNN模型

2. **模型优化方向**：
   - CNN和LSTM模型可通过调整网络结构和超参数进一步提高性能
   - 考虑使用预训练词嵌入（如Word2Vec、BERT）提升模型表现

3. **训练效率优化**：
   - 对CNN和LSTM模型可考虑使用GPU加速训练
   - 调整批量大小和其他训练参数以平衡训练时间和性能

## 实验文件说明

- `experiment_manager.py`：实验管理脚本，用于协调各模型的训练和结果记录
- `experiment_results.csv`：实验结果记录文件
- `bayes_text_classifier.py`：贝叶斯文本分类器实现
- `svm_text_classifier.py`：SVM文本分类器实现
- `cnn_text_classifier.py`：CNN文本分类器实现
- `lstm_text_classifier.py`：LSTM文本分类器实现
- `text_preprocessor.py`: 文本预处理脚本，包括分词、向量化等功能
- 各模型的forward文件：用于模型前向传播的辅助脚本

## 作业实践总结

- 本实验成功实现了四种文本分类模型的训练和预测，并对各模型的性能进行了全面对比分析。实验结果表明，
- 深度学习模型（CNN和LSTM）在准确率方面具有优势，而传统机器学习模型（贝叶斯和SVM）在训练和预测效率方面表现出色。
- 根据实际应用需求，可以选择合适的模型进行文本分类任务。